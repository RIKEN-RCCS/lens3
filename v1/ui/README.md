# Lens3 UI with vuejs+vuetifty

Lens3 UI is created with vuejs+vuetifty.  See
[https://vuejs.org](https://vuejs.org/) and
[https://vuetifyjs.com](https://vuetifyjs.com/en/).

The UI code is stored "v1/src/lenticularis/ui", which is generated by
Vuetify.  They are genetated by running a "vite" build utility in this
directory ("v1/ui") as described below.

## Basic vite build usage

```
% npm create vuetify
% cd ui
% npm install --legacy-peer-deps

% npm run dev
or
% npm run build
or
% npm run lint
```

## Build procedure

A build procedure is as usual.  The files here are derived from the
templates generated by a Vuetify build utility.

(1) Run `npm run build`, which runs a "vite" build and generates
script files and font files in v1/src/lenticularis/ui.  The crucial
configuration line (in "vite.config.ts") is the "base".  It specifies
the paths in the script are relative ones.

```
build: {
  outDir: "../src/lenticularis/ui",
  minify: false,
  emptyOutDir: true,
},
base: "./",
```

(2) Then, run `sh fix-file-in-dist.sh`, which adds a script line in
v1/src/lenticularis/ui/index.html. It is to tell browsers about the
base-path (it is needed for handling rewrites of the URL by a
front-end proxy).  The actual line added is `PLACE_BASE_PATH_HERE`.
This string will be replaced at runtime by the following line.

```
<script type="text/javascript">const base_path_=_api.base_path;</script>
```

The base_path value is taken from the configuration setting.  This
replacement is performed in "api.py".  Modifying the base-path at
runtime is needed to make the UI code deployable.
